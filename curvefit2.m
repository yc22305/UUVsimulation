clear all
clc

% Curve fit (M_B + \Delta M_B) and (\partial \Delta M_B / \partial z_b) using instantaneous flow added mass values at various depths %
% 2018.09.19 SYJ %

% Added mass matrices (M_B + \Delta M_B) for instantaneous flow 
dp02 = [0.361852626796E+01 -0.160656277231E-03 -0.208807145659E-05  0.321312554454E-04  0.246068298468E+01 -0.753307570212E-04
 -0.161754446928E-03  0.852875250427E+02 -0.231237795054E-03 -0.170575050085E+02  0.522337636116E-03  0.376538529687E-03
  0.150689208601E-03 -0.215101858440E-03  0.820187688558E+02  0.430203716908E-04 -0.112406805915E-02  0.337438081714E-03
  0.323508893860E-04 -0.170575050085E+02  0.462475590090E-04  0.341150100171E+01 -0.104467527223E-03 -0.753077059375E-04
  0.248047231656E+01 -0.429522219186E-03 -0.108414271670E-02  0.859044438379E-04  0.159860952238E+02  0.104060294346E-03
 -0.453115772273E-04  0.363334711302E-03 -0.498036924454E-03 -0.726669422614E-04  0.211163853409E-03  0.161630163726E+02];

dp0201 = [0.362672401080E+01 -0.157117745661E-03 -0.417782167386E-05  0.315806668782E-04  0.245509413934E+01 -0.726431228361E-04
 -0.162620226575E-03  0.854816070711E+02 -0.230633368670E-03 -0.171818030213E+02  0.524177973019E-03  0.373254986564E-03
  0.143089964152E-03 -0.189673345075E-03  0.822005865120E+02  0.381243423570E-04 -0.110113957178E-02  0.327336967573E-03
  0.326866655416E-04 -0.171818030213E+02  0.463573071128E-04  0.345354240728E+01 -0.105359772577E-03 -0.750242522995E-04
  0.247430690371E+01 -0.419191911013E-03 -0.106625332488E-02  0.842575741140E-04  0.160133868233E+02  0.101220054666E-03
 -0.442046856667E-04  0.359593545929E-03 -0.498654130411E-03 -0.722783027319E-04  0.207449149453E-03  0.161877395525E+02];

dp03 = [0.423705712205E+01 -0.320653793826E-04 -0.115259026565E-03  0.961961381514E-05  0.221398545493E+01 -0.177912447621E-05
 -0.736472304893E-04  0.974096963730E+02 -0.593350970718E-04 -0.292229089119E+02  0.165897780296E-03  0.263482135106E-04
 -0.134524793527E-03 -0.453978222094E-05  0.943738577400E+02  0.136193465620E-05 -0.346599495490E-03 -0.127558676461E-03
  0.220941691468E-04 -0.292229089119E+02  0.178005291306E-04  0.876687267357E+01 -0.497693340877E-04 -0.790446405269E-05
  0.221587689426E+01  0.113266158471E-03 -0.332970918220E-03 -0.339798475411E-04  0.178335229077E+02  0.117646413635E-04
 -0.107143942676E-05  0.325976605515E-04 -0.177827157384E-03 -0.977929816698E-05  0.380011091240E-04  0.175408825339E+02];

dp0301 = [0.424161178370E+01 -0.321462632244E-04 -0.115651075905E-03  0.967602523036E-05  0.221409256220E+01 -0.206676091172E-05
 -0.723639526708E-04  0.974788744325E+02 -0.518658086843E-04 -0.293411412042E+02  0.162974718335E-03  0.286963169468E-04
 -0.133568582324E-03 -0.164088238129E-04  0.944524297135E+02  0.493905595161E-05 -0.343677326239E-03 -0.133227745292E-03
  0.217815497543E-04 -0.293411412042E+02  0.156116083949E-04  0.883168350246E+01 -0.490553902189E-04 -0.863759140074E-05
  0.221595595830E+01  0.117862034345E-03 -0.329265171657E-03 -0.354764723374E-04  0.178455939988E+02  0.146291937141E-04
 -0.261115811265E-06  0.347072836293E-04 -0.174371470766E-03 -0.104468923745E-04  0.350679395878E-04  0.175476762681E+02];

dp04 = [0.459005963094E+01 -0.945301006210E-05 -0.170561718930E-03  0.378120402448E-05  0.237693916900E+01 -0.340438007862E-05
 -0.921198595053E-05  0.101959311281E+03 -0.135581445810E-04 -0.407837245125E+02  0.184612438950E-04  0.244948465968E-04
 -0.175536718541E-03 -0.103816589115E-03  0.998315437067E+02  0.415266356726E-04 -0.244502252623E-03 -0.582626865038E-04
  0.368479438010E-05 -0.407837245125E+02  0.542325783327E-05  0.163134898050E+02 -0.738449755764E-05 -0.979793863955E-05
  0.237755369106E+01  0.653495999678E-04 -0.250797117761E-03 -0.261398399851E-04  0.187565723638E+02  0.296414347865E-04
 -0.238607490190E-05  0.267871648401E-04 -0.240978052603E-04 -0.107148659365E-04  0.516378977598E-05  0.179524504969E+02];

dp0401 = [0.459274243233E+01 -0.917451392034E-05 -0.171092980715E-03  0.367898008193E-05  0.237976411513E+01 -0.327696425420E-05
 -0.905058122818E-05  0.101988040797E+03 -0.131916457948E-04 -0.408972043596E+02  0.181526363073E-04  0.240803452750E-04
 -0.176077204242E-03 -0.101102614033E-03  0.998681425366E+02  0.405421482178E-04 -0.244618489792E-03 -0.567596132335E-04
  0.362928307245E-05 -0.408972043596E+02  0.528984998036E-05  0.163997789482E+02 -0.727920715943E-05 -0.965621845612E-05
  0.238037410623E+01  0.636060446193E-04 -0.250817613189E-03 -0.255060238940E-04  0.187639257305E+02  0.287455881596E-04
 -0.232141163584E-05  0.263168097507E-04 -0.237135726444E-04 -0.105530407070E-04  0.503309303089E-05  0.179547708142E+02];

dp05 = [0.480293679253E+01  0.356611284023E-06 -0.219390944463E-03 -0.178305642111E-06  0.272915773028E+01  0.238244714321E-06
 -0.388002674233E-06  0.103991875236E+03  0.960498355504E-05 -0.519959376181E+02  0.137356285678E-05  0.596998249164E-05
 -0.218910915240E-03  0.460428967194E-05  0.102511898796E+03 -0.230214483897E-05 -0.265300232866E-03 -0.219617384362E-06
  0.194001337156E-06 -0.519959376181E+02 -0.480249178316E-05  0.259979688090E+02 -0.686781428331E-06 -0.298499124630E-05
  0.272947746278E+01  0.506357141953E-07 -0.263625531779E-03 -0.253178592421E-07  0.194272208783E+02 -0.551315386356E-06
  0.509459651549E-06  0.556673411794E-05 -0.115525482785E-05 -0.278336706230E-05 -0.935873982477E-06  0.181042277591E+02];

dp0501 = [0.480459858724E+01  0.358423671186E-06 -0.219825176605E-03 -0.179211836101E-06  0.272842985923E+01  0.234151463410E-06
 -0.381888155093E-06  0.104005834291E+03  0.949020442006E-05 -0.520029171453E+02  0.135895716523E-05  0.593055712377E-05
 -0.219350772982E-03  0.453253564596E-05  0.102531059300E+03 -0.226626782389E-05 -0.265380614769E-03 -0.215852874917E-06
  0.190944077615E-06 -0.520029171453E+02 -0.474510221133E-05  0.260014585726E+02 -0.679478583154E-06 -0.296527856188E-05
  0.272874801131E+01  0.492241181849E-07 -0.263719362583E-03 -0.246120586623E-07  0.194281440853E+02 -0.547149541169E-06
  0.503254636748E-06  0.552991405212E-05 -0.114154391912E-05 -0.276495702843E-05 -0.927314096604E-06  0.181051678708E+02];

dp06 = [0.493742504695E+01  0.375506194250E-06 -0.259841172359E-03 -0.225303714680E-06  0.317020657587E+01  0.688010412531E-09
 -0.227255943587E-07  0.105030542309E+03  0.236321903366E-05 -0.630183253856E+02  0.479243569190E-06  0.377785516952E-05
 -0.259723929771E-03  0.183584178296E-06  0.103976842620E+03 -0.110150480940E-06 -0.299345953487E-03  0.123856148771E-08
  0.136353563342E-07 -0.630183253856E+02 -0.141793143329E-05  0.378109952314E+02 -0.287546141405E-06 -0.226671310319E-05
  0.317040738572E+01  0.148813955058E-07 -0.298571052246E-03 -0.892883161765E-08  0.200749257822E+02 -0.237223257964E-06
  0.127727517799E-06  0.357149500689E-05 -0.344248863081E-06 -0.214289700661E-05 -0.349184139069E-06  0.181690193712E+02];

dp0601 = [0.493849838707E+01  0.374787822634E-06 -0.260216543774E-03 -0.225247480525E-06  0.317488645440E+01 -0.441540467383E-09
 -0.208479527456E-07  0.105038101076E+03  0.232266497355E-05 -0.631278987467E+02  0.474440080768E-06  0.376819805743E-05
 -0.260101514094E-03  0.160389605026E-06  0.103987840556E+03 -0.963941794495E-07 -0.299720362268E-03  0.235969484318E-08
  0.125296202459E-07 -0.631278987467E+02 -0.139592161615E-05  0.379398671468E+02 -0.285138488099E-06 -0.226468703432E-05
  0.317508638414E+01  0.148747609200E-07 -0.298950861311E-03 -0.893972817992E-08  0.200816171646E+02 -0.235190013515E-06
  0.125663908966E-06  0.356323460020E-05 -0.339946628008E-06 -0.214150399211E-05 -0.345746327401E-06  0.181694470874E+02];

dp07 = [0.502574881944E+01  0.284908640231E-06 -0.294671269161E-03 -0.199436047007E-06  0.365485572731E+01 -0.541056795721E-07
  0.792776859774E-07  0.105614542380E+03 -0.449494603864E-07 -0.739301796663E+02  0.184762290305E-06  0.339160343125E-05
 -0.294707500610E-03 -0.105127724542E-05  0.104845240814E+03  0.735894054955E-06 -0.339037298016E-03  0.616549576501E-07
 -0.554943784493E-07 -0.739301796663E+02  0.314645991553E-07  0.517511257664E+02 -0.129333604901E-06 -0.237412240299E-05
  0.365498763809E+01  0.204736245944E-07 -0.338617466211E-03 -0.143315343316E-07  0.207799541374E+02 -0.102634669860E-06
  0.738818901891E-08  0.328648150582E-05 -0.843833481499E-07 -0.230053705313E-05 -0.132157291187E-06  0.181996821581E+02];

dp0701 = [0.502646689374E+01  0.283958749372E-06 -0.294992409156E-03 -0.199055082351E-06  0.365983817217E+01 -0.542545747911E-07
  0.796861923786E-07  0.105618976230E+03 -0.569501234365E-07 -0.740389023374E+02  0.183129159410E-06  0.339194134110E-05
 -0.295029678700E-03 -0.105579913315E-05  0.104851996037E+03  0.740115180873E-06 -0.339453043443E-03  0.618850196801E-07
 -0.558600219776E-07 -0.740389023374E+02  0.399220309588E-07  0.519012705385E+02 -0.128373540530E-06 -0.237775088088E-05
  0.365996955347E+01  0.205495169747E-07 -0.339035367790E-03 -0.144052122615E-07  0.207874164138E+02 -0.101817746942E-06
  0.680072317905E-08  0.328751770443E-05 -0.829906217740E-07 -0.230454990445E-05 -0.130917871162E-06  0.181998943761E+02];

dp08 = [0.508569007737E+01  0.198514501141E-06 -0.324182889554E-03 -0.158811602434E-06  0.416166044366E+01 -0.529678826841E-07
  0.919996213968E-07  0.105967228508E+03 -0.656029344563E-06 -0.847737828064E+02  0.830880568033E-07  0.363646969161E-05
 -0.324297201444E-03 -0.114651057148E-05  0.105391932971E+03  0.917208482708E-06 -0.381786819927E-03  0.668073360231E-07
 -0.735996966268E-07 -0.847737828064E+02  0.524823494559E-06  0.678190262451E+02 -0.664704473097E-07 -0.290917575226E-05
  0.416175006933E+01  0.267172577613E-07 -0.381506171306E-03 -0.213738158247E-07  0.215723354506E+02 -0.493039029742E-07
 -0.226466857420E-07  0.358192142204E-05 -0.241591306268E-08 -0.286553714683E-05 -0.544889081772E-07  0.182153794713E+02];

dp0801 = [0.508618517551E+01  0.197759185760E-06 -0.324451670241E-03 -0.158405107214E-06  0.416679878939E+01 -0.528585851305E-07
  0.919347111027E-07  0.105969994233E+03 -0.657979574905E-06 -0.848819653807E+02  0.825127754525E-07  0.364047955284E-05
 -0.324566562379E-03 -0.114509032648E-05  0.105396301774E+03  0.917217335212E-06 -0.382223356240E-03  0.667336985640E-07
 -0.736397038413E-07 -0.848819653807E+02  0.527041610875E-06  0.679904542699E+02 -0.660927344966E-07 -0.291602412059E-05
  0.416688808294E+01  0.267630545352E-07 -0.381943508220E-03 -0.214372062965E-07  0.215807482132E+02 -0.489797169836E-07
 -0.227488505464E-07  0.358628210830E-05 -0.200886544573E-08 -0.287261196980E-05 -0.540458658729E-07  0.182154922136E+02];

dp09 = [0.512753787907E+01  0.134428016029E-06 -0.348516847867E-03 -0.120985215971E-06  0.467995897724E+01 -0.397295729301E-07
  0.783979271832E-07  0.106192381237E+03 -0.668504233307E-06 -0.955731431132E+02  0.466528670640E-07  0.411717339392E-05
 -0.348677307674E-03 -0.922793124564E-06  0.105752454006E+03  0.830513850912E-06 -0.425807399895E-03  0.547520356735E-07
 -0.705581348480E-07 -0.955731431132E+02  0.601653850438E-06  0.860158288019E+02 -0.419875795555E-07 -0.370545605596E-05
  0.468002165057E+01  0.293978451126E-07 -0.425572951922E-03 -0.264580609112E-07  0.224638261020E+02 -0.274627057206E-07
 -0.246165761386E-07  0.408830726596E-05  0.188286786740E-07 -0.367947653651E-05 -0.263234009243E-07  0.182239354370E+02];

dp0901 = [0.512788831335E+01  0.133898487538E-06 -0.348734425083E-03 -0.120642535471E-06  0.468517867761E+01 -0.395917478489E-07
  0.782232148023E-07  0.106194192448E+03 -0.667439349449E-06 -0.956809673957E+02  0.464427586172E-07  0.412256172907E-05
 -0.348895248273E-03 -0.920153261515E-06  0.105755396886E+03  0.829058084879E-06 -0.426248924843E-03  0.546037617622E-07
 -0.704791173694E-07 -0.956809673957E+02  0.601362851009E-06  0.862085516235E+02 -0.418449235144E-07 -0.371442811499E-05
  0.468524113540E+01  0.294095124831E-07 -0.426014672464E-03 -0.264979699335E-07  0.224732604468E+02 -0.273236849813E-07
 -0.245825417314E-07  0.409387666299E-05  0.189015785840E-07 -0.368858288060E-05 -0.261585059169E-07  0.182239987618E+02];

dp10 = [0.515748640545E+01  0.905918669258E-07 -0.367792944218E-03 -0.905918666879E-07  0.520425434892E+01 -0.272372298327E-07
  0.605441076467E-07  0.106342632377E+03 -0.524344368705E-06 -0.106342632377E+03  0.326992174259E-07  0.468220324204E-05
 -0.367983023011E-03 -0.666587730872E-06  0.105999199854E+03  0.666587733192E-06 -0.469647308879E-03  0.400021127054E-07
 -0.605441069803E-07 -0.106342632377E+03  0.524344372609E-06  0.106342632377E+03 -0.326992174180E-07 -0.468220324375E-05
  0.520429928706E+01  0.292427039926E-07 -0.469416971167E-03 -0.292427046315E-07  0.234590656508E+02 -0.174312283358E-07
 -0.196648921105E-07  0.466679106700E-05  0.200562025048E-07 -0.466679106815E-05 -0.153393790725E-07  0.182288456820E+02];

dp1001 = [0.515774023943E+01  0.902373894896E-07 -0.367960651485E-03 -0.903276265389E-07  0.520951633489E+01 -0.271286842816E-07
  0.603726755831E-07  0.106343866158E+03 -0.522733358769E-06 -0.106450210024E+03  0.326099212904E-07  0.468801810491E-05
 -0.368150968284E-03 -0.664214246338E-06  0.106001249112E+03  0.664878472049E-06 -0.470080419604E-03  0.398633948272E-07
 -0.604330475998E-07 -0.106450210024E+03  0.523256088198E-06  0.106556660234E+03 -0.326425306310E-07 -0.469270612448E-05
  0.520956112898E+01  0.292294731112E-07 -0.469850001149E-03 -0.292586989151E-07  0.234695492480E+02 -0.173618112075E-07
 -0.196088926346E-07  0.467270287240E-05  0.200292835961E-07 -0.467737556242E-05 -0.152711515308E-07  0.182288829418E+02];

dp15 = [0.522516382746E+01  0.178013634885E-07 -0.395852979512E-03 -0.267020489611E-07  0.784957478961E+01 -0.373654579500E-08
  0.160918785852E-07  0.106646028589E+03 -0.670319559408E-07 -0.159969042883E+03  0.183238149114E-07  0.723764133608E-05
 -0.396085195964E-03 -0.958501177818E-07  0.106517300536E+03  0.143775091294E-06 -0.648161114296E-03  0.438563970637E-08
 -0.241378179177E-07 -0.159969042883E+03  0.100547954511E-06  0.239953564325E+03 -0.274857180634E-07 -0.108564620041E-04
  0.784958612175E+01  0.193091878754E-07 -0.647819916743E-03 -0.289637859727E-07  0.300236531833E+02 -0.392909316194E-08
 -0.354114394058E-08  0.723843816954E-05  0.261963216088E-08 -0.108576572765E-04 -0.383185497221E-08  0.182360926736E+02];

dp1501 = [0.522522995946E+01  0.177605267398E-07 -0.395810513786E-03 -0.266585534449E-07  0.785487121761E+01 -0.372383200664E-08
  0.160612894743E-07  0.106646296848E+03 -0.667376353833E-07 -0.160076091568E+03  0.183107833294E-07  0.724144218523E-05
 -0.396042716394E-03 -0.955096832404E-07  0.106517775154E+03  0.143360013172E-06 -0.648410388812E-03  0.436779674167E-08
 -0.241079972363E-07 -0.160076091568E+03  0.100173272021E-06  0.240274213444E+03 -0.274844865046E-07 -0.108694047216E-04
  0.785488252286E+01  0.192905803566E-07 -0.648068979346E-03 -0.289551722413E-07  0.300394375715E+02 -0.391917748255E-08
 -0.353107994233E-08  0.724224627860E-05  0.260968523445E-08 -0.108706116689E-04 -0.382483801575E-08  0.182360969838E+02];

dp20 = [0.524536823118E+01  0.827090575117E-08 -0.341675939195E-03 -0.165418133444E-07  0.104948711979E+02 -0.889565764800E-09
  0.829706285570E-08  0.106724165214E+03 -0.911069570481E-08 -0.213448330427E+03  0.151909267585E-07  0.830860258391E-05
 -0.341876563512E-03 -0.244771972644E-07  0.106658627526E+03  0.489543792047E-07 -0.704620481142E-03  0.249559972314E-09
 -0.165941270370E-07 -0.213448330427E+03  0.182213770981E-07  0.426896660855E+03 -0.303818567255E-07 -0.166172051674E-04
  0.104948751471E+02  0.149924599037E-07 -0.704221271844E-03 -0.299849189232E-07  0.392332725209E+02 -0.147056845867E-08
 -0.877437879299E-09  0.831083106995E-05  0.179418473359E-10 -0.166216621381E-04 -0.149928160165E-08  0.182371220847E+02];

dp2001 = [0.524539167540E+01  0.826171486251E-08 -0.341518023978E-03 -0.165316851761E-07  0.105001557390E+02 -0.886708241554E-09
  0.828694706731E-08  0.106724250133E+03 -0.909507202624E-08 -0.213555224517E+03  0.151829342496E-07  0.830914791860E-05
 -0.341718553773E-03 -0.244434794882E-07  0.106658786963E+03  0.489114424651E-07 -0.704596857337E-03  0.246421135476E-09
 -0.165821787648E-07 -0.213555224517E+03  0.181992188247E-07  0.427324004258E+03 -0.303810412293E-07 -0.166266049816E-04
  0.105001596808E+02  0.149872397857E-07 -0.704197625690E-03 -0.299894772442E-07  0.392543335835E+02 -0.146505897691E-08
 -0.872600602886E-09  0.831137713102E-05  0.158595330374E-10 -0.166310656229E-04 -0.148962439606E-08  0.182371229205E+02];

unbnd = [0.526116663732E+01 -0.468804891855E-13 -0.140701602398E-12 -0.318348915265E-17 -0.576662855313E-13 -0.303576608296E-14
 -0.146736749060E-12  0.106772634137E+03 -0.122781341308E-11 -0.463043828364E-18  0.282148417432E-12 -0.115053857933E-10
 -0.452524108695E-12 -0.131775950478E-11  0.106768055356E+03  0.991947985668E-19  0.109978511948E-10 -0.271622430351E-12
  0.327392627410E-16 -0.116419162615E-16  0.519518538299E-16  0.118539334664E-32  0.893218038448E-17  0.875028538689E-17
 -0.198972190930E-12  0.291372774782E-12  0.110278348239E-10  0.988102064153E-17  0.182366176890E+02  0.492522655769E-12
 -0.433680868994E-14 -0.115719207654E-10 -0.297927067502E-12  0.840118185275E-17  0.471682316915E-12  0.182374455003E+02];

% (M_B + \Delta M_B)_11 curve fit
zb = [0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1]'; % depth zb : free surface to CG of body
MB11 = [dp02(1,1) dp03(1,1) dp04(1,1) dp05(1,1) dp06(1,1) dp07(1,1) dp08(1,1) dp09(1,1) dp10(1,1)]'; % (M_B + \Delta M_B)_31 elements

f11=fit(zb,MB11,'poly5')
plot(f11,zb,MB11)
title('$M_{B11} + \Delta M_{B11}$ (curve fit function f11)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$M_{B11} + \Delta M_{B11}$','Interpreter','latex','FontSize',14)


% (M_B + \Delta M_B)_31 curve fit
MB31 = [dp02(3,1) dp03(3,1) dp04(3,1) dp05(3,1) dp06(3,1) dp07(3,1) dp08(3,1) dp09(3,1) dp10(3,1)]'; % (M_B + \Delta M_B)_31 elements

f31=fit(zb,MB31,'poly7')
figure
plot(f31,zb,MB31)
title('$M_{B31} + \Delta M_{B31}$ (curve fit function f31)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$M_{B31} + \Delta M_{B31}$','Interpreter','latex','FontSize',14)

% (M_B + \Delta M_B)_33 curve fit
MB33 = [dp02(3,3) dp03(3,3) dp04(3,3) dp05(3,3) dp06(3,3) dp07(3,3) dp08(3,3) dp09(3,3) dp10(3,3)]'; % (M_B + \Delta M_B)_33 elements

f33=fit(zb,MB33,'poly5')
figure
plot(f33,zb,MB33)
title('$M_{B33} + \Delta M_{B33}$ (curve fit function f33)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$M_{B33} + \Delta M_{B33}$','Interpreter','latex','FontSize',14)

% d \Delta M_B11 / d zb curve fit
zb2 = [0.2 0.4 0.5 0.6 0.7 0.8 0.9 1]'; % depth zb : free surface to CG of body; 0.3 omitted (outlier)
dMB11dzb = -1*[(dp02(1,1)-dp0201(1,1))/0.001 (dp04(1,1)-dp0401(1,1))/0.001 (dp05(1,1)-dp0501(1,1))/0.001 (dp06(1,1)-dp0601(1,1))/0.001 (dp07(1,1)-dp0701(1,1))/0.001 (dp08(1,1)-dp0801(1,1))/0.001 (dp09(1,1)-dp0901(1,1))/0.001 (dp10(1,1)-dp1001(1,1))/0.001]';

fdd11=fit(zb2,dMB11dzb,'poly5')
figure
plot(fdd11,zb2,dMB11dzb)
title('$\frac{\partial \Delta M_{B11}}{\partial z_b}$ (curve fit function fdd11)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$\frac{\partial \Delta M_{B11}}{\partial z_b}$','Interpreter','latex','FontSize',14)

% d \Delta M_B31 / d zb curve fit
dMB31dzb = -1*[(dp02(3,1)-dp0201(3,1))/0.001 (dp04(3,1)-dp0401(3,1))/0.001 (dp05(3,1)-dp0501(3,1))/0.001 (dp06(3,1)-dp0601(3,1))/0.001 (dp07(3,1)-dp0701(3,1))/0.001 (dp08(3,1)-dp0801(3,1))/0.001 (dp09(3,1)-dp0901(3,1))/0.001 (dp10(3,1)-dp1001(3,1))/0.001]';

fdd31=fit(zb2,dMB31dzb,'poly6')
figure
plot(fdd31,zb2,dMB31dzb)
title('$\frac{\partial \Delta M_{B31}}{\partial z_b}$ (curve fit function fdd31)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$\frac{\partial \Delta M_{B31}}{\partial z_b}$','Interpreter','latex','FontSize',14)

% d \Delta M_B13 / d zb curve fit
dMB13dzb = -1*[(dp02(1,3)-dp0201(1,3))/0.001 (dp04(1,3)-dp0401(1,3))/0.001 (dp05(1,3)-dp0501(1,3))/0.001 (dp06(1,3)-dp0601(1,3))/0.001 (dp07(1,3)-dp0701(1,3))/0.001 (dp08(1,3)-dp0801(1,3))/0.001 (dp09(1,3)-dp0901(1,3))/0.001 (dp10(1,3)-dp1001(1,3))/0.001]';

fdd13=fit(zb2,dMB13dzb,'poly5')
figure
plot(fdd13,zb2,dMB13dzb)
title('$\frac{\partial \Delta M_{B13}}{\partial z_b}$ (curve fit function fdd13)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$\frac{\partial \Delta M_{B13}}{\partial z_b}$','Interpreter','latex','FontSize',14)

% d \Delta M_B33 / d zb curve fit
dMB33dzb = -1*[(dp02(3,3)-dp0201(3,3))/0.001 (dp04(3,3)-dp0401(3,3))/0.001 (dp05(3,3)-dp0501(3,3))/0.001 (dp06(3,3)-dp0601(3,3))/0.001 (dp07(3,3)-dp0701(3,3))/0.001 (dp08(3,3)-dp0801(3,3))/0.001 (dp09(3,3)-dp0901(3,3))/0.001 (dp10(3,3)-dp1001(3,3))/0.001]';

fdd33=fit(zb2,dMB33dzb,'poly5')
figure
plot(fdd33,zb2,dMB33dzb)
title('$\frac{\partial \Delta M_{B33}}{\partial z_b}$ (curve fit function fdd33)','Interpreter','latex','FontSize',14)
xlabel('Depth $z_b$','Interpreter','latex','FontSize',14)
ylabel('$\frac{\partial \Delta M_{B33}}{\partial z_b}$','Interpreter','latex','FontSize',14)
%}